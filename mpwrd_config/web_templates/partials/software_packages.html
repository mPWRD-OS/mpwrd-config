{% if packages %}
  {% for pkg in packages %}
  <details class="details">
    <summary>{{ pkg.name }} ({% if pkg.installed %}installed{% else %}not installed{% endif %})</summary>
    <pre class="mono">{% if pkg.description %}Description: {{ pkg.description }}
{% endif %}Options: {{ pkg.options }}</pre>
    <div class="button-stack">
      {% if 'l' in pkg.options and pkg.installed %}
      <form method="post" action="/actions/software/{{ pkg.key }}/run">
        <button class="button ghost" type="submit">Run</button>
      </form>
      {% endif %}
      {% if 'i' in pkg.options and not pkg.installed %}
      <form method="post" action="/actions/software/{{ pkg.key }}/install" onsubmit="return confirm('Install {{ pkg.name }}?');">
        <button class="button ghost" type="submit">Install</button>
      </form>
      {% endif %}
      {% if 'u' in pkg.options and pkg.installed %}
      <form method="post" action="/actions/software/{{ pkg.key }}/uninstall" onsubmit="return confirm('Uninstall {{ pkg.name }}?');">
        <button class="button ghost" type="submit">Uninstall</button>
      </form>
      {% endif %}
      {% if 'a' in pkg.options and pkg.installed %}
      <form method="post" action="/actions/software/{{ pkg.key }}/init">
        <button class="button ghost" type="submit">Initialize</button>
      </form>
      {% endif %}
      {% if 'g' in pkg.options and pkg.installed %}
      <form method="post" action="/actions/software/{{ pkg.key }}/upgrade">
        <button class="button ghost" type="submit">Upgrade</button>
      </form>
      {% endif %}
      {% if 'G' in pkg.options %}
      <form method="post" action="/actions/software/{{ pkg.key }}/license">
        <button class="button ghost" type="submit">License</button>
      </form>
      {% endif %}
      {% for extra in pkg.extra_actions %}
      <form method="post" action="/actions/software/{{ pkg.key }}/extra">
        <input type="hidden" name="action" value="{{ extra[0] }}" />
        <button class="button ghost" type="submit">{{ extra[1] }}</button>
      </form>
      {% endfor %}
    </div>
    {% if 'e' in pkg.options and pkg.installed %}
    <div class="button-stack">
      <form method="post" action="/actions/software/{{ pkg.key }}/service">
        <input type="hidden" name="action" value="status" />
        <button class="button ghost" type="submit">Service Status</button>
      </form>
      <form method="post" action="/actions/software/{{ pkg.key }}/service">
        <input type="hidden" name="action" value="enable" />
        <button class="button ghost" type="submit">Enable Service</button>
      </form>
      <form method="post" action="/actions/software/{{ pkg.key }}/service">
        <input type="hidden" name="action" value="disable" />
        <button class="button ghost" type="submit">Disable Service</button>
      </form>
      <form method="post" action="/actions/software/{{ pkg.key }}/service">
        <input type="hidden" name="action" value="restart" />
        <button class="button ghost" type="submit">Restart Service</button>
      </form>
      <form method="post" action="/actions/software/{{ pkg.key }}/service">
        <input type="hidden" name="action" value="stop" />
        <button class="button ghost" type="submit">Stop Service</button>
      </form>
    </div>
    {% endif %}
  </details>
  {% endfor %}
{% else %}
  <p>No packages found.</p>
{% endif %}
